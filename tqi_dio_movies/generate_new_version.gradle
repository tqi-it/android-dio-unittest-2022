task generateNewVersion() {
    doFirst {
        print("\n------ Generating new version ------\n")
        def versionFile = file('app/version.properties')
        if (versionFile.canRead()) {
            def versionProperties = new Properties()
            versionFile.withInputStream { versionProperties.load(it) }

            def versionCode = versionProperties['VERSION_CODE'].toInteger() + 1
            versionProperties['VERSION_CODE'] = versionCode.toString()

            versionProperties.VERSION_NAME = newVersionName
            versionProperties.store(versionFile.newWriter(), null)
            print("\nversion $newVersionName generated\n")

            print("\n------ Finished ------\n")
        } else {
            throw new GradleException("version.properties not found")
        }
    }
}